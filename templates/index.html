{% extends "layout.html" %}
{% block faviconType %}favicon.ico{% endblock %}

{% block container %}
<h3>Formulario de solicitud</h3>
<div class="borderTable align-middle">
    <!-- TODO: Añadir los campos del formulario de google -->
    <form id="reqForm" action="/solicitar" method="post">
    <table id="licencias" class="table table-striped table-hover" style="width:100%">
      <thead>
        <tr>
          <th>Título</th>
          <th>ISBN</th>
          <th>Número de licencias</th>
        </tr>
      </thead>
      <tbody>
        <!-- TODO: Aquí hay que añadir los filtros entre el título y el ISBN -->
        <th><input type="text" name="title_1" required></th>
        <th><input type="text" name="isbn_1" required></th>
        <th><input type="number" name="numlic_1" required></th>
      </tbody>
      <tfoot>
        <tr id="add">
          <td>
            <!-- TODO: Acabar la función addBook -->
            <a href="#/" onclick="addBook()"><svg class="plusIcon" xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 448 512">
                <path
                  d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z" />
              </svg></a>
          </td>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td>
            {% if role == "interno" or role == "promotor" %}
            <th><button type="button" id="showModal" class="btn btn-primary">Enviar</button></th>
            {% else %}
            <th><button type="submit" name="action" value="solicitar">Solicitar</th>
            {% endif %}
          </td>
          <td></td>
        </tr>
      </tfoot>
    </table>
    <div class="modal fade" id="sendModal" tabindex="-1" aria-labelledby="sendModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Enviar mensaje</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancelar"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label">Destinatario:</label>
                <input type="text" name="email" class="form-control" id="recipient-name">
              </div>
              <div class="mb-3">
                <label for="message-text" class="col-form-label">Mensaje:</label>
                <textarea class="form-control" name="message" id="message-text"></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            <button type="submit" name="action" value="solicitar" class="btn btn-primary">Enviar</button>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>

{% endblock %}

{% block user_info %}
  {{ super() }}
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    var showModal = document.getElementById("showModal")

    showModal.onclick = function () {
      var form = document.getElementById("reqForm")
      if (! form.checkValidity()){
        alert("Se han de rellenar todos los campos")
      }else{
        var myModal = new bootstrap.Modal(document.getElementById('sendModal'), {
        keyboard: false
        });
        myModal.show();
      }
    }
  </script>
  <script src="{{ url_for('static', filename='js/bookFunctions.js')}}"></script>
{% endblock %}